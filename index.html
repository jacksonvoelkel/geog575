<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <meta name="author" content=" Instructor: Jackson Voelkel (jvoelkel@pdx.edu)" />
  <title></title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="index_files/reveal.js-3.3.0.1/css/reveal.css"/>



<link rel="stylesheet" href="index_files/reveal.js-3.3.0.1/css/theme/black.css" id="theme">

<style type="text/css">
.reveal section img {
  background: rgba(255, 255, 255, 0.85);
}
</style>

  <!-- some tweaks to reveal css -->
  <style type="text/css">
    .reveal h1 { font-size: 2.0em; }
    .reveal h2 { font-size: 1.5em;  }
    .reveal h3 { font-size: 1.25em;	}
    .reveal h4 { font-size: 1em;	}

    .reveal .slides>section,
    .reveal .slides>section>section {
      padding: 0px 0px;
    }



    .reveal table {
      border-width: 1px;
      border-spacing: 2px;
      border-style: dotted;
      border-color: gray;
      border-collapse: collapse;
      font-size: 0.7em;
    }

    .reveal table th {
      border-width: 1px;
      padding-left: 10px;
      padding-right: 25px;
      font-weight: bold;
      border-style: dotted;
      border-color: gray;
    }

    .reveal table td {
      border-width: 1px;
      padding-left: 10px;
      padding-right: 25px;
      border-style: dotted;
      border-color: gray;
    }


  </style>

    <style type="text/css">code{white-space: pre;}</style>


<!-- Printing and PDF exports -->
<script id="paper-css" type="application/dynamic-css">

/* Default Print Stylesheet Template
   by Rob Glazebrook of CSSnewbie.com
   Last Updated: June 4, 2008

   Feel free (nay, compelled) to edit, append, and
   manipulate this file as you see fit. */


@media print {

	/* SECTION 1: Set default width, margin, float, and
	   background. This prevents elements from extending
	   beyond the edge of the printed page, and prevents
	   unnecessary background images from printing */
	html {
		background: #fff;
		width: auto;
		height: auto;
		overflow: visible;
	}
	body {
		background: #fff;
		font-size: 20pt;
		width: auto;
		height: auto;
		border: 0;
		margin: 0 5%;
		padding: 0;
		overflow: visible;
		float: none !important;
	}

	/* SECTION 2: Remove any elements not needed in print.
	   This would include navigation, ads, sidebars, etc. */
	.nestedarrow,
	.controls,
	.fork-reveal,
	.share-reveal,
	.state-background,
	.reveal .progress,
	.reveal .backgrounds {
		display: none !important;
	}

	/* SECTION 3: Set body font face, size, and color.
	   Consider using a serif font for readability. */
	body, p, td, li, div {
		font-size: 20pt!important;
		font-family: Georgia, "Times New Roman", Times, serif !important;
		color: #000;
	}

	/* SECTION 4: Set heading font face, sizes, and color.
	   Differentiate your headings from your body text.
	   Perhaps use a large sans-serif for distinction. */
	h1,h2,h3,h4,h5,h6 {
		color: #000!important;
		height: auto;
		line-height: normal;
		font-family: Georgia, "Times New Roman", Times, serif !important;
		text-shadow: 0 0 0 #000 !important;
		text-align: left;
		letter-spacing: normal;
	}
	/* Need to reduce the size of the fonts for printing */
	h1 { font-size: 28pt !important;  }
	h2 { font-size: 24pt !important; }
	h3 { font-size: 22pt !important; }
	h4 { font-size: 22pt !important; font-variant: small-caps; }
	h5 { font-size: 21pt !important; }
	h6 { font-size: 20pt !important; font-style: italic; }

	/* SECTION 5: Make hyperlinks more usable.
	   Ensure links are underlined, and consider appending
	   the URL to the end of the link for usability. */
	a:link,
	a:visited {
		color: #000 !important;
		font-weight: bold;
		text-decoration: underline;
	}
	/*
	.reveal a:link:after,
	.reveal a:visited:after {
		content: " (" attr(href) ") ";
		color: #222 !important;
		font-size: 90%;
	}
	*/


	/* SECTION 6: more reveal.js specific additions by @skypanther */
	ul, ol, div, p {
		visibility: visible;
		position: static;
		width: auto;
		height: auto;
		display: block;
		overflow: visible;
		margin: 0;
		text-align: left !important;
	}
	.reveal pre,
	.reveal table {
		margin-left: 0;
		margin-right: 0;
	}
	.reveal pre code {
		padding: 20px;
		border: 1px solid #ddd;
	}
	.reveal blockquote {
		margin: 20px 0;
	}
	.reveal .slides {
		position: static !important;
		width: auto !important;
		height: auto !important;

		left: 0 !important;
		top: 0 !important;
		margin-left: 0 !important;
		margin-top: 0 !important;
		padding: 0 !important;
		zoom: 1 !important;

		overflow: visible !important;
		display: block !important;

		text-align: left !important;
		-webkit-perspective: none;
		   -moz-perspective: none;
		    -ms-perspective: none;
		        perspective: none;

		-webkit-perspective-origin: 50% 50%;
		   -moz-perspective-origin: 50% 50%;
		    -ms-perspective-origin: 50% 50%;
		        perspective-origin: 50% 50%;
	}
	.reveal .slides section {
		visibility: visible !important;
		position: static !important;
		width: auto !important;
		height: auto !important;
		display: block !important;
		overflow: visible !important;

		left: 0 !important;
		top: 0 !important;
		margin-left: 0 !important;
		margin-top: 0 !important;
		padding: 60px 20px !important;
		z-index: auto !important;

		opacity: 1 !important;

		page-break-after: always !important;

		-webkit-transform-style: flat !important;
		   -moz-transform-style: flat !important;
		    -ms-transform-style: flat !important;
		        transform-style: flat !important;

		-webkit-transform: none !important;
		   -moz-transform: none !important;
		    -ms-transform: none !important;
		        transform: none !important;

		-webkit-transition: none !important;
		   -moz-transition: none !important;
		    -ms-transition: none !important;
		        transition: none !important;
	}
	.reveal .slides section.stack {
		padding: 0 !important;
	}
	.reveal section:last-of-type {
		page-break-after: avoid !important;
	}
	.reveal section .fragment {
		opacity: 1 !important;
		visibility: visible !important;

		-webkit-transform: none !important;
		   -moz-transform: none !important;
		    -ms-transform: none !important;
		        transform: none !important;
	}
	.reveal section img {
		display: block;
		margin: 15px 0px;
		background: rgba(255,255,255,1);
		border: 1px solid #666;
		box-shadow: none;
	}

	.reveal section small {
		font-size: 0.8em;
	}

}  
</script>


<script id="pdf-css" type="application/dynamic-css">
    
/**
 * This stylesheet is used to print reveal.js
 * presentations to PDF.
 *
 * https://github.com/hakimel/reveal.js#pdf-export
 */

* {
	-webkit-print-color-adjust: exact;
}

body {
	margin: 0 auto !important;
	border: 0;
	padding: 0;
	float: none !important;
	overflow: visible;
}

html {
	width: 100%;
	height: 100%;
	overflow: visible;
}

/* Remove any elements not needed in print. */
.nestedarrow,
.reveal .controls,
.reveal .progress,
.reveal .playback,
.reveal.overview,
.fork-reveal,
.share-reveal,
.state-background {
	display: none !important;
}

h1, h2, h3, h4, h5, h6 {
	text-shadow: 0 0 0 #000 !important;
}

.reveal pre code {
	overflow: hidden !important;
	font-family: Courier, 'Courier New', monospace !important;
}

ul, ol, div, p {
	visibility: visible;
	position: static;
	width: auto;
	height: auto;
	display: block;
	overflow: visible;
	margin: auto;
}
.reveal {
	width: auto !important;
	height: auto !important;
	overflow: hidden !important;
}
.reveal .slides {
	position: static;
	width: 100%;
	height: auto;

	left: auto;
	top: auto;
	margin: 0 !important;
	padding: 0 !important;

	overflow: visible;
	display: block;

	-webkit-perspective: none;
	   -moz-perspective: none;
	    -ms-perspective: none;
	        perspective: none;

	-webkit-perspective-origin: 50% 50%; /* there isn't a none/auto value but 50-50 is the default */
	   -moz-perspective-origin: 50% 50%;
	    -ms-perspective-origin: 50% 50%;
	        perspective-origin: 50% 50%;
}

.reveal .slides section {
	page-break-after: always !important;

	visibility: visible !important;
	position: relative !important;
	display: block !important;
	position: relative !important;

	margin: 0 !important;
	padding: 0 !important;
	box-sizing: border-box !important;
	min-height: 1px;

	opacity: 1 !important;

	-webkit-transform-style: flat !important;
	   -moz-transform-style: flat !important;
	    -ms-transform-style: flat !important;
	        transform-style: flat !important;

	-webkit-transform: none !important;
	   -moz-transform: none !important;
	    -ms-transform: none !important;
	        transform: none !important;
}

.reveal section.stack {
	margin: 0 !important;
	padding: 0 !important;
	page-break-after: avoid !important;
	height: auto !important;
	min-height: auto !important;
}

.reveal img {
	box-shadow: none;
}

.reveal .roll {
	overflow: visible;
	line-height: 1em;
}

/* Slide backgrounds are placed inside of their slide when exporting to PDF */
.reveal section .slide-background {
	display: block !important;
	position: absolute;
	top: 0;
	left: 0;
	width: 100%;
	z-index: -1;
}

/* All elements should be above the slide-background */
.reveal section>* {
	position: relative;
	z-index: 1;
}

/* Display slide speaker notes when 'showNotes' is enabled */
.reveal .speaker-notes-pdf {
	display: block;
	width: 100%;
	max-height: none;
	left: auto;
	top: auto;
	z-index: 100;
}

/* Display slide numbers when 'slideNumber' is enabled */
.reveal .slide-number-pdf {
	display: block;
	position: absolute;
	font-size: 14px;
}

</script>


<script>
var style = document.createElement( 'style' );
style.type = 'text/css';
var style_script_id = window.location.search.match( /print-pdf/gi ) ? 'pdf-css' : 'paper-css';
var style_script = document.getElementById(style_script_id).text;
style.innerHTML = style_script;
document.getElementsByTagName('head')[0].appendChild(style);
</script>

</head>
<body>
  <div class="reveal">
    <div class="slides">

<section>
    <h1 class="title">GEOG 4/575: <br>
<h2>
Digital Compliation and Database Design
<h2></h1>
    <h2 class="author"><br>Instructor: Jackson Voelkel (<a href='mailto:jvoelkel@pdx.edu' target='_blank'>jvoelkel@pdx.edu</a>)</h2>
    <h3 class="date">Winter 2018</h3>
</section>

<section><section id="gis-data-management" class="titleslide slide level1"><h1>GIS Data Management</h1></section><section id="section" class="slide level2">
<h2></h2>
<p><img src='http://jacksonvoelkel.com/geog575/images/clutter.jpg'></p>
</section></section>
<section><section id="database---definition" class="titleslide slide level1"><h1>Database - Definition</h1></section><section id="section-1" class="slide level2">
<h2></h2>
<p>A very large, <font style='color:orange'>integrated</font> collection of data.</p>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<style>
    .reveal section img { background:none; border:none; box-shadow:none; }
</style>
</section><section id="section-2" class="slide level2">
<h2></h2>
<p>A <font style='color:orange'>shared</font> collection of logically related data designed to meet the information needs of an organization.</p>
<ul>
<li>User doesn’t need to know how data are physically stored</li>
<li>Requires access control, etc.</li>
</ul>
</section><section id="section-3" class="slide level2">
<h2></h2>
<p>Models of the “real world”.</p>
<ul>
<li>Entities (e.g. students, courses)</li>
<li>Relationships (e.g. ‘Jackson <font style='color:magenta'>[person]</font> likes Pizza <font style='color:magenta'>[food]</font>’)</li>
</ul>
</section></section>
<section><section id="what-does-a-database-do" class="titleslide slide level1"><h1>What Does a Database Do?</h1></section><section id="section-4" class="slide level2">
<h2></h2>
<p><img src='http://jacksonvoelkel.com/geog575/images/data_model1.png'></p>
</section><section id="section-5" class="slide level2">
<h2></h2>
<p><img src='http://jacksonvoelkel.com/geog575/images/DBMS.jpg'></p>
</section><section id="esri-stack" class="slide level2">
<h2>ESRI Stack</h2>
<p><img src='http://jacksonvoelkel.com/geog575/images/ESRI_GIS_Stack.jpg'></p>
</section><section id="section-6" class="slide level2">
<h2></h2>
<div class="stretch">
<p><iframe style="width:100%;height:100%;" src="https://www.portlandmaps.com"> <img src='http://jacksonvoelkel.com/geog575/images/backup_pdx_maps.png'> </iframe></p>
</div>
</section><section id="open-source-stack" class="slide level2">
<h2>Open Source Stack</h2>
<p><img src='http://jacksonvoelkel.com/geog575/images/OS_GIS_Stack.jpg'></p>
</section><section id="section-7" class="slide level2">
<h2></h2>
<div class="stretch">
<p><iframe style="width:100%;height:100%;" src="http://cmap.clackamas.us/maps/cmap"> <img src='http://jacksonvoelkel.com/geog575/images/backup_c_maps.png'> </iframe></p>
</div>
</section></section>
<section><section id="what-is-a-relation" class="titleslide slide level1"><h1>What is a ‘relation’?</h1></section><section id="section-8" class="slide level2">
<h2></h2>
<p><img src='http://jacksonvoelkel.com/geog575/images/database_diagram-Relations.png'></p>
</section><section id="section-9" class="slide level2">
<h2></h2>
<p><img src='http://jacksonvoelkel.com/geog575/images/data_model_tiger.png'></p>
</section><section id="cardinality" class="slide level2">
<h2>Cardinality</h2>
<p><img src='http://jacksonvoelkel.com/geog575/images/cardinality_graphical.png'></p>
</section><section id="section-10" class="slide level2">
<h2></h2>
<p><img src='http://jacksonvoelkel.com/geog575/images/cardinality.png'></p>
</section></section>
<section><section id="how-does-the-data-get-stored" class="titleslide slide level1"><h1>How does the data get stored?</h1></section><section id="section-11" class="slide level2">
<h2></h2>
<pre style="font-family:courier;font-size:12pt">
geog575=# \d countries
                                   Table "public.countries"
   Column   |         Type          |                        Modifiers                        
------------+-----------------------+---------------------------------------------------------
 gid        | integer               | not null default nextval('countries_gid_seq'::regclass)
 fips_cntry | character varying(2)  | 
 gmi_cntry  | character varying(3)  | 
 iso_2digit | character varying(2)  | 
 iso_3digit | character varying(3)  | 
 iso_num    | smallint              | 
 cntry_name | character varying(40) | 
 long_name  | character varying(40) | 
 isoshrtnam | character varying(45) | 
 unshrtnam  | character varying(55) | 
 locshrtnam | character varying(43) | 
 loclngnam  | character varying(74) | 
 status     | character varying(60) | 
 pop2007    | double precision      | 
 sqkm       | double precision      | 
 sqmi       | double precision      | 
 land_sqkm  | integer               | 
 colormap   | smallint              | default 0
 the_geom   | geometry              | 

Indexes:
 "countries_pkey" PRIMARY KEY, btree (gid)
Check constraints:
  "countries_sqkm_check" CHECK (sqkm > 0::double precision)
  "countries_sqmi_check" CHECK (sqmi > 0::double precision)
  "countries_cntry_name_check" CHECK (cntry_name::text !~ '[^a-zA-Z.&, ''-]'::text)
  "enforce_dims_the_geom" CHECK (st_ndims(the_geom) = 2)
  "enforce_geotype_the_geom" CHECK (geometrytype(the_geom) = 'MULTIPOLYGON' OR the_geom IS NULL)
  "enforce_srid_the_geom" CHECK (st_srid(the_geom) = 3995)
</pre>
</section><section id="section-12" class="slide level2">
<h2></h2>
<pre style="font-family:courier;font-size:12pt">
geog575=# \d countries
                                   Table "public.countries"
   Column   |         Type          |                        Modifiers                        
------------+-----------------------+---------------------------------------------------------
 gid        | <font style='color:magenta'>integer</font>               | not null default nextval('countries_gid_seq'::regclass)
 fips_cntry | <font style='color:lightgreen'>character</font> varying(2)  | 
 gmi_cntry  | character varying(3)  | 
 iso_2digit | character varying(2)  | 
 iso_3digit | character varying(3)  | 
 iso_num    | <font style='color:magenta'>smallint</font>              | 
 cntry_name | character varying(40) | 
 long_name  | character varying(40) | 
 isoshrtnam | character varying(45) | 
 unshrtnam  | character varying(55) | 
 locshrtnam | character varying(43) | 
 loclngnam  | character varying(74) | 
 status     | character varying(60) | 
 pop2007    | <font style='color:magenta'>double precision</font>      | 
 sqkm       | double precision      | 
 sqmi       | double precision      | 
 land_sqkm  | integer               | 
 colormap   | smallint              | default 0
 the_geom   | <font style='color:red'>geometry</font>              | 

Indexes:
 "countries_pkey" PRIMARY KEY, btree (gid)
Check constraints:
  "countries_sqkm_check" CHECK (sqkm > 0::double precision)
  "countries_sqmi_check" CHECK (sqmi > 0::double precision)
  "countries_cntry_name_check" CHECK (cntry_name::text !~ '[^a-zA-Z.&, ''-]'::text)
  "enforce_dims_the_geom" CHECK (st_ndims(the_geom) = 2)
  "enforce_geotype_the_geom" CHECK (geometrytype(the_geom) = 'MULTIPOLYGON' OR the_geom IS NULL)
  "enforce_srid_the_geom" CHECK (st_srid(the_geom) = 3995)
</pre>
</section><section id="representing-numbers" class="slide level2">
<h2>Representing Numbers</h2>
<h4>
Binary Numbers
</h4>
<pre style="font-family:courier;font-size:12pt">

   Number   |   Code    |   Bit Depth                        
------------+-----------+---------------
0           | 0         |      1
1           | 1         |      1
2           | 10        |      2
3           | 11        |      2
4           | 100       |      3
5           | 101       |      3
6           | 110       |      3
7           | 111       |      3
8           | 1000      |      4
9           | 1001      |      4
10          | 1010      |      4
11          | 1011      |      4
12          | 1100      |      4
13          | 1101      |      4
14          | 1110      |      4
15          | 1111      |      4
</pre>
</section><section id="section-13" class="slide level2">
<h2></h2>
<p><img src='http://jacksonvoelkel.com/geog575/images/number_types.png'></p>
</section><section id="ascii" class="slide level2">
<h2>ASCII</h2>
<p><font style='color:orange'>A</font>merican <font style='color:orange'>S</font>tandards <font style='color:orange'>C</font>ode for <font style='color:orange'>I</font>nformation <font style='color:orange'>I</font>nterchange</p>
</section><section id="section-14" class="slide level2">
<h2></h2>
<p>128 Characters:</p>
<pre style="font-family:courier;font-size:12pt">
Char  Dec  Oct  Hex | Char  Dec  Oct  Hex | Char  Dec  Oct  Hex | Char Dec  Oct   Hex
-------------------------------------------------------------------------------------
(nul)   0 0000 0x00 | (sp)   32 0040 0x20 | @      64 0100 0x40 | `      96 0140 0x60
(soh)   1 0001 0x01 | !      33 0041 0x21 | A      65 0101 0x41 | a      97 0141 0x61
(stx)   2 0002 0x02 | "      34 0042 0x22 | B      66 0102 0x42 | b      98 0142 0x62
(etx)   3 0003 0x03 | #      35 0043 0x23 | C      67 0103 0x43 | c      99 0143 0x63
(eot)   4 0004 0x04 | $      36 0044 0x24 | D      68 0104 0x44 | d     100 0144 0x64
(enq)   5 0005 0x05 | %      37 0045 0x25 | E      69 0105 0x45 | e     101 0145 0x65
(ack)   6 0006 0x06 | &      38 0046 0x26 | F      70 0106 0x46 | f     102 0146 0x66
(bel)   7 0007 0x07 | '      39 0047 0x27 | G      71 0107 0x47 | g     103 0147 0x67
(bs)    8 0010 0x08 | (      40 0050 0x28 | H      72 0110 0x48 | h     104 0150 0x68
(ht)    9 0011 0x09 | )      41 0051 0x29 | I      73 0111 0x49 | i     105 0151 0x69
(nl)   10 0012 0x0a | *      42 0052 0x2a | J      74 0112 0x4a | j     106 0152 0x6a
(vt)   11 0013 0x0b | +      43 0053 0x2b | K      75 0113 0x4b | k     107 0153 0x6b
(np)   12 0014 0x0c | ,      44 0054 0x2c | L      76 0114 0x4c | l     108 0154 0x6c
(cr)   13 0015 0x0d | -      45 0055 0x2d | M      77 0115 0x4d | m     109 0155 0x6d
(so)   14 0016 0x0e | .      46 0056 0x2e | N      78 0116 0x4e | n     110 0156 0x6e
(si)   15 0017 0x0f | /      47 0057 0x2f | O      79 0117 0x4f | o     111 0157 0x6f
(dle)  16 0020 0x10 | 0      48 0060 0x30 | P      80 0120 0x50 | p     112 0160 0x70
(dc1)  17 0021 0x11 | 1      49 0061 0x31 | Q      81 0121 0x51 | q     113 0161 0x71
(dc2)  18 0022 0x12 | 2      50 0062 0x32 | R      82 0122 0x52 | r     114 0162 0x72
(dc3)  19 0023 0x13 | 3      51 0063 0x33 | S      83 0123 0x53 | s     115 0163 0x73
(dc4)  20 0024 0x14 | 4      52 0064 0x34 | T      84 0124 0x54 | t     116 0164 0x74
(nak)  21 0025 0x15 | 5      53 0065 0x35 | U      85 0125 0x55 | u     117 0165 0x75
(syn)  22 0026 0x16 | 6      54 0066 0x36 | V      86 0126 0x56 | v     118 0166 0x76
(etb)  23 0027 0x17 | 7      55 0067 0x37 | W      87 0127 0x57 | w     119 0167 0x77
(can)  24 0030 0x18 | 8      56 0070 0x38 | X      88 0130 0x58 | x     120 0170 0x78
(em)   25 0031 0x19 | 9      57 0071 0x39 | Y      89 0131 0x59 | y     121 0171 0x79
(sub)  26 0032 0x1a | :      58 0072 0x3a | Z      90 0132 0x5a | z     122 0172 0x7a
(esc)  27 0033 0x1b | ;      59 0073 0x3b | [      91 0133 0x5b | {     123 0173 0x7b
(fs)   28 0034 0x1c | <      60 0074 0x3c | \      92 0134 0x5c | |     124 0174 0x7c
(gs)   29 0035 0x1d | =      61 0075 0x3d | ]      93 0135 0x5d | }     125 0175 0x7d
(rs)   30 0036 0x1e | >      62 0076 0x3e | ^      94 0136 0x5e | ~     126 0176 0x7e
(us)   31 0037 0x1f | ?      63 0077 0x3f | _      95 0137 0x5f | (del) 127 0177 0x7f
</pre>
</section><section id="utf" class="slide level2">
<h2>UTF</h2>
<p><font style='color:orange'>U</font>nicode (Universal Coded Character Set) <font style='color:orange'>T</font>ransformation <font style='color:orange'>F</font>ormat</p>
<p>1,112,064 Characters!</p>
</section><section id="section-15" class="slide level2">
<h2></h2>
<p><img src='http://jacksonvoelkel.com/geog575/images/utf8_use.png'></p>
</section><section id="section-16" class="slide level2">
<h2></h2>
<pre style="font-family:courier;font-size:12pt">
gis=# \l
                                  List of databases
   Name    |  Owner   | Encoding |  Collation  |    Ctype    |   Access privileges   
-----------+----------+----------+-------------+-------------+-----------------------
 gis       | postgres | <font style='color:orange'>UTF8</font>     | en_US.UTF-8 | en_US.UTF-8 | 
</pre>
</section></section>
<section><section id="week-1-review-what-can-go-wrong" class="titleslide slide level1"><h1>Week 1 Review: What can go wrong?</h1></section><section id="whats-wrong" class="slide level2">
<h2>What’s wrong?</h2>
<p><img src='http://jacksonvoelkel.com/geog575/slide_images/2_plant_db.png'></p>
<p class="fragment">
Find all “Hedging”: IF use1 = ‘hedging’ OR use2 = ‘hedging’ …
</p>
<p class="fragment">
How many uses can we have?
</p>
</section><section id="how-can-we-fix-this" class="slide level2">
<h2>How can we fix this?</h2>
<div class="stretch fragment">
<p><img src='http://jacksonvoelkel.com/geog575/slide_images/2_plant_db2.png'></p>
</div>
</section><section id="how-can-we-determine-what-is-a-use" class="slide level2">
<h2>How can we determine what is a “use”?</h2>
<p class="fragment">
Chinchilla hallucinogenic
</p>
<p class="fragment">
Swinging like Tarzan
</p>
</section><section id="how-can-we-restrict-these-uses" class="slide level2">
<h2>How can we restrict these uses?</h2>
<p>User input, field restrictions, etc (Churcher Ch. 11)</p>
</section><section id="whats-wrong-1" class="slide level2">
<h2>What’s wrong?</h2>
<p><img src='http://jacksonvoelkel.com/geog575/slide_images/2_insect_db.png'></p>
<p class="fragment">
Farm/Field repeated enough that errors are likely.
</p>
<p class="fragment">
Date is repeated for every entry.
</p>
</section><section id="how-can-we-fix-this-1" class="slide level2">
<h2>How can we fix this?</h2>
<div class="stretch fragment">
<p><img src='http://jacksonvoelkel.com/geog575/slide_images/2_insect_db2.png'></p>
</div>
</section><section id="section-17" class="slide level2">
<h2></h2>
<p>Why did that work? What are we actually measuring here (farms, insects, etc)?</p>
</section></section>
<section><section id="week-1-review-data-modeling" class="titleslide slide level1"><h1>Week 1 Review: Data Modeling</h1></section><section id="relationships" class="slide level2">
<h2>Relationships</h2>
<p>What is the cardinality?</p>
<p><img src='http://jacksonvoelkel.com/geog575/slide_images/2_plant_db2.png'></p>
</section><section id="section-18" class="slide level2">
<h2></h2>
<p>
What could be a real 1.1 &lt; - - - &gt; 1.1 cardinality?
</p>
<p class="fragment">
[US Citizens]1.1 &lt; - - - &gt; 1.1[SSN]
</p>
<p class="fragment">
What could be a 0.1 &lt; - - - &gt; 1.1?
</p>
<p class="fragment">
[Observation]0.1 &lt; - - - &gt; 1.1[Tree Falling]?
</p>
</section></section>
<section><section id="week-1-review-use-cases" class="titleslide slide level1"><h1>Week 1 Review: Use Cases</h1></section><section id="what-canshould-be-recorded" class="slide level2">
<h2>What can/should be recorded?</h2>
<p class="fragment">
Get in the head of the actor!
</p>
</section><section id="gis-use-cases" class="slide level2">
<h2>GIS Use Cases</h2>
<p class="fragment">
What are they? (e.g. in business, government, academics, etc.)
</p>
</section></section>
<section><section id="lab-questions" class="titleslide slide level1"><h1>Lab Questions?</h1></section><section id="section-19" class="slide level2">
<h2></h2>
<p class="fragment">
… besides problem 12 …
</p>
</section><section id="section-20" class="slide level2">
<h2></h2>
<ol type="1">
<li>Why won’t the SELECT clause work without the FROM clause?</li>
</ol>
</section><section id="section-21" class="slide level2">
<h2></h2>
<ol start="2" type="1">
<li>When you use the ORDER BY clause and choose the option descending, what does that do to the data returned?</li>
</ol>
</section><section id="section-22" class="slide level2">
<h2></h2>
<ol start="3" type="1">
<li>What would be the ordering of the following statement:</li>
</ol>
<pre>
SELECT prod_desc,prod_id,prod_price
FROM products
ORDER BY 3,1;
</pre>
</section><section id="section-23" class="slide level2">
<h2></h2>
<ol start="4" type="1">
<li>What is another way to write the ORDER clause in the previous query?</li>
</ol>
</section><section id="section-24" class="slide level2">
<h2></h2>
<ol start="5" type="1">
<li>Can I have more than one AND in the WHERE clause?</li>
</ol>
</section><section id="section-25" class="slide level2">
<h2></h2>
<ol start="6" type="1">
<li>True or false: Both conditions when using the OR operator must be TRUE.</li>
</ol>
</section><section id="section-26" class="slide level2">
<h2></h2>
<ol start="7" type="1">
<li>True or false: All speciﬁed values must match when using the IN operator.</li>
</ol>
</section><section id="section-27" class="slide level2">
<h2></h2>
<ol start="8" type="1">
<li>True or false: The AND operator can be used in the SELECT and the WHERE clauses.</li>
</ol>
</section><section id="section-28" class="slide level2">
<h2></h2>
<ol start="9" type="1">
<li>What is the logical negation of the IN operator?</li>
</ol>
</section><section id="section-29" class="slide level2">
<h2></h2>
<ol start="10" type="1">
<li>Write a SELECT statement that returns the name and cost of each product from the products. Which product is the most expensive?</li>
</ol>
</section><section id="section-30" class="slide level2">
<h2></h2>
<ol start="11" type="1">
<li>Write a query that generates a list of all customers and their email addresses.</li>
</ol>
</section><section id="section-31" class="slide level2">
<h2></h2>
<ol start="12" type="1">
<li>Using the customer table, write a SELECT statement that returns customer IDs and customer names (in alphabetical order) for customers who live in Indiana, Ohio, Michigan, or Illinois and whose names begin with the letters A or B. (Note: the query will not return any rows, the point is to write the query).</li>
</ol>
</section><section id="section-32" class="slide level2">
<h2></h2>
<ol start="13" type="1">
<li>Using the products table, write a SELECT statement that returns the product ID, product description, and product cost. Limit the product cost to between $4.00 and $10.00.</li>
</ol>
<pre>
SELECT prod_id, prod_desc, prod_price
FROM products
WHERE prod_price BETWEEN 4.00 AND 10.00; 
</pre>
</section><section id="section-33" class="slide level2">
<h2></h2>
<ol start="14" type="1">
<li>Assuming that you used the BETWEEN operator in the previous question, rewrite your SQL statement to achieve the same results using diﬀerent operators. If you did not use the BETWEEN operator, do so now.</li>
</ol>
<pre>
SELECT prod_id, prod_desc, prod_price
FROM products
WHERE prod_price > 4.00
AND prod_price < 10.00;
</pre>
</section><section id="section-34" class="slide level2">
<h2></h2>
<ol start="15" type="1">
<li>Pick three items from the products table. Now write a query to return the rows of data from the table associated with those three items. Now rewrite the query to return everything but those three items. For your query use combinations of equality operators and conjunctive operators.</li>
</ol>
</section></section>
<section><section id="data-integrity" class="titleslide slide level1"><h1>Data Integrity</h1></section><section id="acid" class="slide level2">
<h2>ACID</h2>
</section><section id="atomicity" class="slide level2">
<h2><font style='color:orange;text-align:left;'>A</font>tomicity</h2>
<p>Either all of a trasaction is executed or none of it is - a transaction can never be partially completed.</p>
</section><section id="atomicity-1" class="slide level2">
<h2><font style='color:orange;text-align:left;'>A</font>tomicity</h2>
<div style="font-size:20pt">
<p class="fragment" align="left">
<font style='color:lightblue;font-family:courier;'><b>00</b> BEGIN;</font><font style='color:grey;font-family:courier;'> - -Starts a transaction</font>
</p>
<p class="fragment" align="left">
HR’s Balance is $2,000
</p>
<p class="fragment" align="left">
IT’s Balance is $5,000
</p>
<p class="fragment" align="left">
<font style='color:lightblue;font-family:courier;'><b>01</b> UPDATE accounts SET balance=balance-1000 WHERE account_code=‘HR’;</font>
</p>
<p class="fragment" align="left">
<font style='color:red;'><b>- - - POWER OUTAGE - - -</b></font>
</p>
<p class="fragment" align="left">
<font style='color:lightblue;font-family:courier;'><b>02</b> SELECT balance FROM accounts WHERE account_code=‘HR’;</font>
</p>
<p class="fragment" align="left">
HR’s Balance is $ ? <font style="color:green" class="fragment">$2,000!</font>
</p>
<p class="fragment" align="left">
IT’s Balance is $ ? <font style="color:green" class="fragment">$5,000!</font>
</p>
</div>
</section><section id="consistency" class="slide level2">
<h2><font style='color:orange;text-align:left;'>C</font>onsistency</h2>
<p>Data in a database remain, before and after the transaction, in a “consistent state” as specified by the database schema and other constraints and integrity rules imposed on the database.</p>
</section><section id="section-35" class="slide level2">
<h2></h2>
<p>Limits:</p>
<ul>
<li>Pizza toppings</li>
<li><b>Plant uses</b></li>
<li>Age (&lt;= 125)</li>
</ul>
</section><section id="section-36" class="slide level2">
<h2></h2>
<p>Constraint:</p>
<ul>
<li>Can’t add farm without field</li>
<li>Can’t add a duplicate entry</li>
</ul>
</section><section id="isolation" class="slide level2">
<h2><font style='color:orange;text-align:left;'>I</font>solation</h2>
<p>Requires the results of simultaneous transactions to be independent of each other.</p>
</section><section id="durability" class="slide level2">
<h2><font style='color:orange;text-align:left;'>D</font>urability</h2>
<p>After the completion of a transaction, its results can and always will be traced even if the system fails or crashes.</p>
<p class="fragment">
The transaction is incomplete until the results are stored!
</p>
</section></section>
<section><section id="keys" class="titleslide slide level1"><h1>Keys</h1></section><section id="section-37" class="slide level2">
<h2></h2>
<pre><span class="inner-pre" style="font-size:11px">
SELECT * FROM employees;
  emp_id   | last_name | first_name | middle_name |        address        |     city     | state |  zip  |   phone    |   pager    
-----------+-----------+------------+-------------+-----------------------+--------------+-------+-------+------------+------------
 311549902 | STEPHENS  | TINA       | DAWN        | RR 3 BOX 17A          | GREENWOOD    | IN    | 47890 | 3178784465 | 
 442346889 | PLEW      | LINDA      | CAROL       | 3301 BEACON           | INDIANAPOLIS | IN    | 46224 | 3172978990 | 
 213764555 | GLASS     | BRANDON    | SCOTT       | 1710 MAIN ST          | WHITELAND    | IN    | 47885 | 3178984321 | 3175709980
 313782439 | GLASS     | JACOB      |             | 3789 WHITE RIVER BLVD | INDIANAPOLIS | IN    | 45734 | 3175457676 | 8887345678
 220984332 | WALLACE   | MARIAH     |             | 7889 KEYSTONE AVE     | INDIANAPOLIS | IN    | 46741 | 3173325986 | 
 443679012 | SPURGEON  | TIFFANY    |             | 5 GEORGE COURT        | INDIANAPOLIS | IN    | 46234 | 3175679007 | 

SELECT * FROM employee_pay;
  emp_id   |   position    | date_hire  | pay_rate | date_last_raise |  salary  |  bonus  
-----------+---------------+------------+----------+-----------------+----------+---------
 311549902 | MARKETING     | 1989-05-23 |          | 1999-05-01      | 40000.00 |        
 442346889 | TEAM LEADER   | 1990-06-17 |    14.75 | 1999-06-01      |          |        
 213764555 | SALES MANAGER | 1994-08-14 |          | 1999-08-01      | 30000.00 | 2000.00
 313782439 | SALESMAN      | 1997-06-28 |          |                 | 20000.00 | 1000.00
 220984332 | SHIPPER       | 1996-07-22 |    11.00 | 1999-07-01      |          |        
 443679012 | SHIPPER       | 1991-01-14 |    15.00 | 1999-01-01      |          |        
</span></pre>
</section><section id="primary" class="slide level2">
<h2>Primary</h2>
<pre><span class="inner-pre" style="font-size:11px">
SELECT * FROM employee_pay;
  emp_id   |   position    | date_hire  | pay_rate | date_last_raise |  salary  |  bonus  
-----------+---------------+------------+----------+-----------------+----------+---------
<font style='color:orange'> 311549902</font> | MARKETING     | 1989-05-23 |          | 1999-05-01      | 40000.00 |        
<font style='color:orange'> 442346889</font> | TEAM LEADER   | 1990-06-17 |    14.75 | 1999-06-01      |          |        
<font style='color:orange'> 213764555</font> | SALES MANAGER | 1994-08-14 |          | 1999-08-01      | 30000.00 | 2000.00
<font style='color:orange'> 313782439</font> | SALESMAN      | 1997-06-28 |          |                 | 20000.00 | 1000.00
<font style='color:orange'> 220984332</font> | SHIPPER       | 1996-07-22 |    11.00 | 1999-07-01      |          |        
<font style='color:orange'> 443679012</font> | SHIPPER       | 1991-01-14 |    15.00 | 1999-01-01      |          |        
</span></pre>
</section><section id="foreign" class="slide level2">
<h2>Foreign?</h2>
<pre><span class="inner-pre" style="font-size:11px">
SELECT * FROM employee_pay;
  emp_id   |   position    | date_hire  | pay_rate | date_last_raise |  salary  |  bonus  
-----------+---------------+------------+----------+-----------------+----------+---------
<font style='color:orange'> 311549902</font> | MARKETING     | 1989-05-23 |          | 1999-05-01      | 40000.00 |        
<font style='color:orange'> 442346889</font> | TEAM LEADER   | 1990-06-17 |    14.75 | 1999-06-01      |          |        
<font style='color:orange'> 213764555</font> | SALES MANAGER | 1994-08-14 |          | 1999-08-01      | 30000.00 | 2000.00
<font style='color:orange'> 313782439</font> | SALESMAN      | 1997-06-28 |          |                 | 20000.00 | 1000.00
<font style='color:orange'> 220984332</font> | SHIPPER       | 1996-07-22 |    11.00 | 1999-07-01      |          |        
<font style='color:orange'> 443679012</font> | SHIPPER       | 1991-01-14 |    15.00 | 1999-01-01      |          |        
</span></pre>
<p>They’re the same!</p>
</section><section id="insect-observations" class="slide level2">
<h2>Insect Observations</h2>
<div class="stretch">
<p><img src='http://jacksonvoelkel.com/geog575/slide_images/2_insect_db2.png'></p>
</div>
</section></section>
<section><section id="next-week" class="titleslide slide level1"><h1>Next Week…</h1></section><section id="joins" class="slide level2">
<h2>JOINS!</h2>
</section></section>
<section><section id="added-two-presentations" class="titleslide slide level1"><h1>Added two presentations:</h1></section><section id="micah-babinski-gisp---221" class="slide level2">
<h2>Micah Babinski, GISP - 2/21</h2>
<p>Bureau of Land Management</p>
</section><section id="will-garrick---228" class="slide level2">
<h2>Will Garrick - 2/28</h2>
<p>Portland State University Research Computing</p>
</section></section>
<section><section id="week-2-review-bian" class="titleslide slide level1"><h1>Week 2 Review: Bian</h1></section><section id="section-38" class="slide level2">
<h2></h2>
<ul>
<li>Why did we read this?</li>
<li>How does this tie into use cases?</li>
<li>What main points is she trying to make?</li>
</ul>
</section><section id="section-39" class="slide level2">
<h2></h2>
<ul>
<li>What types of data (spatial or otherwise) may pose conceptual issues by constraining them to ‘objects’?</li>
<li>Examples of fields?</li>
<li>[ Spatial residual example in R ]</li>
</ul>
</section><section id="section-40" class="slide level2">
<h2></h2>
<p>When all you have is a hammer, everything looks like a nail.</p>
</section></section>
<section><section id="week-2-review-lab" class="titleslide slide level1"><h1>Week 2 review: Lab</h1></section><section id="section-41" class="slide level2">
<h2>1</h2>
<p>True or false: The AVG function returns an average of all rows from a SELECT column, includingany NULL values.</p>
<ul>
<li>Either!!! Null is NOTHING, not 0!</li>
</ul>
</section><section id="section-42" class="slide level2">
<h2>2</h2>
<p>Must a column appear in the SELECT statement to use a GROUP BY clause on it?</p>
<ul>
<li>No!</li>
</ul>
<pre class="fragment">SELECT AVG(prod_price)
FRom products
GROUP BY <span class="inner-pre" style="color:orange;">vend_id</span>;
</pre>
</section><section id="section-43" class="slide level2">
<h2>3</h2>
<p>True or false: You must also use the GROUP BY clause when using the HAVING clause.</p>
<ul>
<li>TRUE… some aggregation must happen!</li>
</ul>
</section><section id="section-44" class="slide level2">
<h2>4</h2>
<p>What could be a major factor concerning the representation and comparison of date and time values ifyour company is an international organization?</p>
<ul>
<li>Month/Day/Year vs. Day/Month/Year</li>
</ul>
</section><section id="section-45" class="slide level2">
<h2>5</h2>
<p>Will the following SELECT statements work? If not, what fixes thestatements? If so, why?</p>
<pre >SELECT COUNT(prod_id), prod_price
FROM products;
</pre>
<ul>
<li>Doesn’t work! COUNT() will just return a single number.. either remove count or remove prod_price</li>
</ul>
<pre>SELECT MIN(BONUS), MAX(SALARY)
FROM EMPLOYEE_PAY
WHERE SALARY > 20000;
</pre>
<ul>
<li>Works fine! However, what’s odd about it?</li>
<li>Capitalization</li>
</ul>
</section><section id="section-46" class="slide level2">
<h2>7</h2>
<p>What is the average salary?</p>
<ul>
<li>30000.00</li>
</ul>
<pre class="fragment">SELECT AVG(salary)
FROM employee_pay;</pre>
</section><section id="section-47" class="slide level2">
<h2>8</h2>
<p>What is the maximum bonus?</p>
<ul>
<li>2000.00</li>
</ul>
<pre class="fragment">SELECT MAX(bonus)
FROM employee_pay;</pre>
</section><section id="section-48" class="slide level2">
<h2>9</h2>
<p>What are the total salaries?</p>
<ul>
<li>90000.00</li>
</ul>
<pre class="fragment">SELECT SUM(salary)
FROM employee_pay;</pre>
</section><section id="section-49" class="slide level2">
<h2>10</h2>
<p>What is the minimum pay rate?</p>
<ul>
<li>11.00</li>
</ul>
<pre class="fragment">SELECT MIN(pay_rate)
FROM employee_pay;</pre>
</section><section id="section-50" class="slide level2">
<h2>11</h2>
<p>How many rows are in the table?</p>
<ul>
<li>6</li>
</ul>
<pre class="fragment">SELECT COUNT(*)
FROM employee_pay;</pre>
</section><section id="section-51" class="slide level2">
<h2>12</h2>
<p>Enter the following query to show all cities in the employees table:</p>
<pre>SELECT city
FROM employees;</pre>
<p>Describe how the results compare to this query:</p>
<pre>SELECT city
    , count(*)
FROM employees
GROUP BY city;</pre>
</section><section id="section-52" class="slide level2">
<h2>12 (2)</h2>
<p>No duplicates, instead shows a count of how many times that city occurs.</p>
</section><section id="section-53" class="slide level2">
<h2>13</h2>
<p>Modify the previous query to only return data for cities having more than one employee.</p>
<pre class="fragment">SELECT city
    , count(*)
FROM employees
GROUP BY city
HAVING count(*) > 1;</pre>
</section><section id="section-54" class="slide level2">
<h2>14</h2>
<p>Modify the previous query to order the results in descending order, from highest count to lowest.</p>
<pre class="fragment">SELECT city
    , count(*)
FROM employees
GROUP BY city
ORDER BY 2 DESC;</pre>
<ul>
<li>Or…</li>
</ul>
<pre class="fragment">SELECT city
    , count(*)
FROM employees
GROUP BY city
ORDER BY count(*) DESC;</pre>
</section><section id="section-55" class="slide level2">
<h2>15</h2>
<p>Write a query to list the average pay rate and salary by position from the employee_pay table.</p>
<pre class="fragment">SELECT position
    ,AVG(salary) avg_salary
    ,AVG(pay_rate) avg_payrate
FROM employee_pay GROUP BY position;</pre>
</section><section id="section-56" class="slide level2">
<h2>16</h2>
<p>Write a query to list the average salary by position from the employee_pay table where the averagesalary is greater than $20,000.</p>
<pre class="fragment">SELECT position
    ,AVG(salary) avg_salary
FROM employee_pay GROUP BY position
HAVING AVG(salary) > 20000;</pre>
</section><section id="section-57" class="slide level2">
<h2>17</h2>
<p>Using the employee table, write an SQL statement that lists employee email addresses. Email is not astored column, so give it an alias. The email address for each employee should be as follows:<a href="mailto:first.last@example.com">first.last@example.com</a>. For example, John Smith’s email address is <a href="mailto:john.smith@example.com">john.smith@example.com</a>.</p>
<pre class="fragment">SELECT (<span style="color:orange">LOWER(first_name)</span> || '.'  || LOWER(last_name) || '@example.com') <span style="color:purple">emails</span>
FROM employees;</pre>
<ul>
<li>LOWER()!</li>
<li>give it an alias (in the instructions)!</li>
</ul>
</section><section id="section-58" class="slide level2">
<h2>18</h2>
<p>Refer to the PostgreSQL string function documentation. In particular, we want to pay attention to the substr() or substring() functions – they do the same thing, the syntax is just slightly different., These functions select just a portion of a given string, given a starting position, and the number of characters you want selected. Write a SQL statement that selects from the employees table each employee’s name, employee ID, and phone number in the following formats:</p>
<p>The name should be displayed as “Smith, John” (this requires a case conversion function). The employee ID should be displayed as 999-99-9999. The phone number should be displayed as (999) 999-9999.</p>
</section><section id="section-59" class="slide level2">
<h2>18 (2)</h2>
<p>Did you find “INITCAP”? Google and ctrl+f are <em>crucial</em>.</p>
<pre>SELECT INITCAP('thIs funCtiON iS suPER hELPful!');</pre>
<pre>SELECT
<span style="color:orange">INITCAP(LOWER(last_name))</span> || ', ' || INITCAP(LOWER(first_name)) emp_name
    , SUBSTR(emp_id,1,3) || '-' || SUBSTR(emp_id,4,2) || '-' || SUBSTR(emp_id,6,4) emp_id
    , '(' || SUBSTR(phone,1,3) || ') ' || SUBSTR(phone,3,3) || '-' || SUBSTR(phone,6,4) emp_phone
FROM employees;</pre>
</section><section id="section-60" class="slide level2">
<h2>19</h2>
<p>Refer to the at PostgreSQL date documentation. Write a query that shows what day of the week each employee was hired.</p>
<ul>
<li>TO_CHAR!</li>
</ul>
<pre class="fragment">SELECT emp_id
    <span style="font-color:orange">,</span>INITCAP(<span style="color:orange">TO_CHAR(date_hire,'day')</span>) hire_dat
FROM employee_pay;</pre>
</section></section>
<section><section id="joins-1" class="titleslide slide level1"><h1>Joins</h1></section><section id="why" class="slide level2">
<h2>Why?</h2>
<ul>
<li>The true power of an RDMS</li>
<li>We’ve been ripping tables apart (normalization) <em>because</em> we have joins!</li>
</ul>
</section><section id="inner-join" class="slide level2">
<h2>Inner Join</h2>
<pre>SELECT * FROM TableA
INNER JOIN TableB
ON TableA.name = TableB.name
</pre>
</section><section id="section-61" class="slide level2">
<h2></h2>
<div class="stretch">
<p><img src='http://jacksonvoelkel.com/geog575/slide_images/join_inner.jpg'></p>
</div>
</section><section id="section-62" class="slide level2">
<h2></h2>
<pre>
SELECT * FROM employees e 
INNER JOIN vendors v 
ON e.state = v.vend_state;
</pre>
<p>… No matches!</p>
</section><section id="full-outer-join" class="slide level2">
<h2>Full Outer Join</h2>
<pre>SELECT * FROM TableA
FULL OUTER JOIN TableB
ON TableA.name = TableB.name
</pre>
</section><section id="section-63" class="slide level2">
<h2></h2>
<div class="stretch">
<p><img src='http://jacksonvoelkel.com/geog575/slide_images/join_full_outer.jpg'></p>
</div>
</section><section id="section-64" class="slide level2">
<h2></h2>
<pre>
SELECT * FROM orderitems oi
FULL OUTER JOIN products p 
ON oi.prod_id = p.prod_id;
</pre>
<p>Returns all records when there is a match in either table.</p>
</section><section id="left-outer-join-aka-join" class="slide level2">
<h2>Left Outer Join (AKA JOIN)</h2>
<pre>SELECT * FROM TableA
LEFT OUTER JOIN TableB
ON TableA.name = TableB.name
</pre>
</section><section id="section-65" class="slide level2">
<h2></h2>
<div class="stretch">
<p><img src='http://jacksonvoelkel.com/geog575/slide_images/join_left_outer.jpg'></p>
</div>
</section><section id="section-66" class="slide level2">
<h2></h2>
<pre>
SELECT * FROM products p
LEFT OUTER JOIN orderitems oi
ON oi.prod_id = p.prod_id;
</pre>
<p>Returns everything that matches the ‘left’ table.</p>
</section><section id="section-67" class="slide level2">
<h2></h2>
<pre>
SELECT * FROM orders o
JOIN customers c
ON o.cust_id = c.cust_id;
</pre>
<p>Find customer info for all orders placed</p>
</section><section id="section-68" class="slide level2">
<h2></h2>
<pre>
SELECT * FROM orders o
FULL OUTER JOIN customers c
ON o.cust_id = c.cust_id;
</pre>
<p>What will this do?</p>
</section><section id="anti-join" class="slide level2">
<h2>Anti-Join</h2>
<p>Postgres using SQL logic, not a specific function!</p>
<pre>SELECT * FROM TableA
LEFT OUTER JOIN TableB
ON TableA.name = TableB.name
WHERE TableB.name IS null
</span></pre>
</section><section id="section-69" class="slide level2">
<h2></h2>
<div class="stretch">
<p><img src='http://jacksonvoelkel.com/geog575/slide_images/join_anti.jpg'></p>
</div>
</section><section id="section-70" class="slide level2">
<h2></h2>
<pre>
SELECT * FROM orders o
FULL OUTER JOIN customers c
ON o.cust_id = c.cust_id
WHERE o.order_num IS NULL;
</pre>
</section></section>
<section><section id="next-week-1" class="titleslide slide level1"><h1>Next Week:</h1></section><section id="database-normalization" class="slide level2">
<h2>Database Normalization</h2>
<div class="stretch">
<p><img src='http://jacksonvoelkel.com/geog575/slide_images/homer.gif'></p>
</div>
</section></section>
<section><section id="week-3-review-lab" class="titleslide slide level1"><h1>Week 3 review: Lab</h1></section><section id="section-71" class="slide level2">
<h2>1</h2>
<p>When using a base table to join unrelated tables, must you select any columns from the base table?</p>
</section><section id="section-72" class="slide level2">
<h2></h2>
<p>No! They must be called, but don’t have to be selected.</p>
<pre>SELECT order_num FROM orders o
JOIN customers c
ON o.cust_id = c.cust_id;</pre>
</section><section id="section-73" class="slide level2">
<h2>2</h2>
<p>Can you join a table on more than one column?</p>
</section><section id="section-74" class="slide level2">
<h2></h2>
<p>Yes</p>
<pre>SELECT e.emp_id
FROM employees e
JOIN vendors v
  ON e.first_name = v.vend_name
  <span style="color:orange">AND</span> e.city = v.vend_city;</pre>
<p>No error!</p>
</section><section id="section-75" class="slide level2">
<h2>3</h2>
<p>What type of join would you use to return records from one table, regardless of the existence of associated records in the related table?</p>
</section><section id="section-76" class="slide level2">
<h2></h2>
<p>LEFT OUTER will return everything from specified field!</p>
<pre>SELECT c.cust_id
FROM customers c
<span style="color:orange">JOIN</span> orders o
ON c.cust_id<span style="color:red">::integer</span> = o.order_num;</pre>
<pre>SELECT c.cust_id
FROM customers c
<span style="color:orange">LEFT OUTER JOIN</span> orders o
ON c.cust_id::integer = o.order_num;</pre>
<p>In this case, LEFT OUTER JOIN results in the same thing as</p>
<pre>SELECT cust_id FROM customers;</pre>
</section><section id="section-77" class="slide level2">
<h2></h2>
<p>Remember: LEFT OUTER JOIN is the same as LEFT JOIN (you can’t have the left side of the ‘inner’ part)</p>
<pre>SELECT c.cust_id
FROM customers c
<span style="color:orange">LEFT JOIN</span> orders o
ON c.cust_id::integer = o.order_num;</pre>
</section><section id="section-78" class="slide level2">
<h2>4</h2>
<p>What type of join do you use to test equality among rows of related tables?</p>
</section><section id="section-79" class="slide level2">
<h2></h2>
<p>INNER JOIN</p>
<ul>
<li>Only returns matches between the tables</li>
</ul>
</section><section id="section-80" class="slide level2">
<h2>5</h2>
<p>What happens if you select from two different tables but fail to join the tables?</p>
</section><section id="section-81" class="slide level2">
<h2></h2>
<p>A Cartesian Product!</p>
<pre>SELECT * from employees<span style="color:orange">,</span> employee_pay;</pre>
<pre>SELECT * from employees e
<span style="color:orange">JOIN</span> employee_pay ep
  ON e.emp_id = ep.emp_id;</pre>
</section><section id="section-82" class="slide level2">
<h2>6</h2>
<p>What is the function of a subquery when used with a SELECT statement?</p>
</section><section id="section-83" class="slide level2">
<h2></h2>
<ul>
<li>Similar to ‘IN’</li>
<li>Allows for more complex queries</li>
<li>Allows for more ‘dynamic’ processes</li>
</ul>
</section><section id="section-84" class="slide level2">
<h2>7</h2>
<p>Which of the query combining operators accomplishes each of these:</p>
</section><section id="section-85" class="slide level2">
<h2>7.1</h2>
<p>Shows duplicates</p>
</section><section id="section-86" class="slide level2">
<h2></h2>
<p>UNION ALL</p>
</section><section id="section-87" class="slide level2">
<h2>7.2</h2>
<p>Return only rows from the first query that match those in the second query</p>
</section><section id="section-88" class="slide level2">
<h2></h2>
<p>INTERSECT</p>
</section><section id="section-89" class="slide level2">
<h2>7.3</h2>
<p>Return no duplicates</p>
</section><section id="section-90" class="slide level2">
<h2></h2>
<p>UNION</p>
</section><section id="section-91" class="slide level2">
<h2>7.4</h2>
<p>Return only rows from the first query not returned by the second</p>
</section><section id="section-92" class="slide level2">
<h2></h2>
<p>EXCEPT</p>
</section><section id="section-93" class="slide level2">
<h2>8</h2>
<p>Using a subquery, write a query that returns the names of all employees who have a pay rate greater than Linda Plew, whose employee identification number is 442346889.</p>
</section><section id="section-94" class="slide level2">
<h2></h2>
<p>First (more of a mental excercise):</p>
<pre class="fragment">SELECT pay_rate
FROM employee_pay
WHERE emp_id = '442346889';</pre>
</section><section id="section-95" class="slide level2">
<h2></h2>
<p>Second:</p>
<pre>SELECT emp_id
FROM employee_pay
WHERE pay_rate > (
    SELECT pay_rate
    FROM employee_pay
    WHERE emp_id = '442346889');</pre>
</section><section id="section-96" class="slide level2">
<h2></h2>
<p>Final:</p>
<pre>SELECT first_name
FROM employees
WHERE emp_id IN (
SELECT emp_id
FROM employee_pay
WHERE pay_rate > (
    SELECT pay_rate
    FROM employee_pay
    WHERE emp_id = '442346889'));</pre>
</section><section id="section-97" class="slide level2">
<h2></h2>
<p>… or, nicer:</p>
<pre>SELECT INITCAP(first_name) || ' ' || INITCAP(last_name) AS emp_name
FROM employees
WHERE emp_id IN (
SELECT emp_id
FROM employee_pay
WHERE pay_rate > (
    SELECT pay_rate
    FROM employee_pay
    WHERE emp_id = '442346889'));</pre>
</section><section id="section-98" class="slide level2">
<h2></h2>
<p>Other?</p>
</section><section id="section-99" class="slide level2">
<h2>9</h2>
<p>Using a subquery, write a query that lists all products that cost more than the average cost of all products.</p>
</section><section id="section-100" class="slide level2">
<h2></h2>
<p>First:</p>
<pre>SELECT AVG(prod_price)
FROM Products;</pre>
</section><section id="section-101" class="slide level2">
<h2></h2>
<p>Final:</p>
<pre>SELECT prod_name
    ,prod_price
FROM Products
WHERE prod_price > (
    SELECT AVG(prod_price)
    FROM Products);</pre>
</section><section id="section-102" class="slide level2">
<h2>10</h2>
<p>Write a compound query to find the customers who have placed an order.</p>
</section><section id="section-103" class="slide level2">
<h2></h2>
<pre>SELECT cust_id
FROM Customers;</pre>
<pre>SELECT cust_id
FROM Orders;</pre>
</section><section id="section-104" class="slide level2">
<h2></h2>
<pre>SELECT cust_id
FROM Customers
INTERSECT
SELECT cust_id
FROM Orders;</pre>
</section><section id="section-105" class="slide level2">
<h2>11</h2>
<p>Write a compound query to find the customers who have not placed an order.</p>
</section><section id="section-106" class="slide level2">
<h2></h2>
<pre>SELECT cust_id
FROM Customers
EXCEPT
SELECT cust_id
FROM Orders;</pre>
</section></section>
<section><section id="normalization" class="titleslide slide level1"><h1>Normalization</h1></section></section>
<section><section id="first-normal-form" class="titleslide slide level1"><h1>First Normal Form</h1></section><section id="section-107" class="slide level2">
<h2></h2>
<div class="stretch">
<p><img src='http://jacksonvoelkel.com/geog575/slide_images/norm_1st.png'></p>
</div>
</section><section id="section-108" class="slide level2">
<h2></h2>
<p>What is wrong with multiple values in a single field?</p>
<ul>
<li>All or nothing (no unique values)</li>
</ul>
</section><section id="section-109" class="slide level2">
<h2></h2>
<p>Are we done?</p>
<blockquote class="fragment">
If a table is not in first normal form, remove the multivalued information from the table. Create a new table with that information and the primary key of the original table
</blockquote>
</section><section id="section-110" class="slide level2">
<h2></h2>
<div class="stretch">
<p><img src='http://jacksonvoelkel.com/geog575/slide_images/norm_1st_2.png'></p>
</div>
</section></section>
<section><section id="second-normal-form" class="titleslide slide level1"><h1>Second Normal Form</h1></section><section id="section-111" class="slide level2">
<h2></h2>
<div class="stretch">
<p><img src='http://jacksonvoelkel.com/geog575/slide_images/norm_2nd_1.png'></p>
</div>
<p>Is it in first normal form? What is the PK?</p>
<ul>
<li>empID and project_num</li>
</ul>
</section><section id="section-112" class="slide level2">
<h2></h2>
<p>Issue:</p>
<p class="fragment">
We don’t <i>need</i> the primary key to figure out everything!
</p>
<p class="fragment">
What are hours dependent on?
</p>
<ul>
<li>empID</li>
<li>proj_num</li>
</ul>
<p class="fragment">
What is ‘contact’ denpendent on? ‘project_name’?
</p>
<ul>
<li>proj_num</li>
</ul>
</section><section id="section-113" class="slide level2">
<h2></h2>
<blockquote>
A table is in second normal form if it is in first normal form AND we need ALL the fields in the key to determine the values of the non–key fields.
</blockquote>
</section><section id="section-114" class="slide level2">
<h2></h2>
<blockquote>
If a table is not in second normal form, remove those non–key fields that are not dependent on the whole of the primary key. Create another table with these fields and the part of the primary key on which they do depend
</blockquote>
</section><section id="section-115" class="slide level2">
<h2></h2>
<p>What tables should we make?</p>
<div class="stretch">
<p><img src='http://jacksonvoelkel.com/geog575/slide_images/norm_2nd_1.png'></p>
</div>
</section><section id="section-116" class="slide level2">
<h2></h2>
<div class="stretch">
<p><img src='http://jacksonvoelkel.com/geog575/slide_images/norm_2nd_2.png'></p>
</div>
<p>Do we need all of the fields in the key to determin the values of the non-key fields?</p>
</section><section id="section-117" class="slide level2">
<h2></h2>
<p>Note: we can still have multi-field PKs! But every other field must be dependent upon the <i><b>entire</b></i> PK!</p>
</section></section>
<section><section id="third-normal-form" class="titleslide slide level1"><h1>Third Normal Form</h1></section><section id="section-118" class="slide level2">
<h2></h2>
<div class="stretch">
<p><img src='http://jacksonvoelkel.com/geog575/slide_images/norm_3rd_1.png'></p>
</div>
<div style="text-align:left">
<p>What is the Pk? <span class="fragment" style="color:orange">empID</span></p>
<p>Is it in Frist Normal Form? <span class="fragment" style="color:orange">Yes</span></p>
<p>Is it in Second Normal Form? <span class="fragment" style="color:orange">Yes, empID is the only part of the key!</span></p>
</div>
</section><section id="so-what-is-wrong" class="slide level2">
<h2>So what is wrong?</h2>
<div class="stretch">
<p><img src='http://jacksonvoelkel.com/geog575/slide_images/norm_3rd_1.png'></p>
</div>
<ul>
<li><p>dep_name repeats</p></li>
<li><p>What can determine dep_name?</p></li>
<li>if empID = 1001… dep_name = Marketing</li>
<li><p>if dept_num = 2… dep_name = Marketing</p></li>
</ul>
</section><section id="section-119" class="slide level2">
<h2></h2>
<blockquote>
A table is in third normal form if it is in second normal form AND no non–key fields are depend on a field(s) that is not the primary key.
</blockquote>
</section><section id="section-120" class="slide level2">
<h2></h2>
<blockquote>
If a table is not in third normal form, remove the non–key fields that are dependent on a field(s) that is not the primary key. Create another table with this field(s) and the field on which it does depend.
</blockquote>
</section><section id="section-121" class="slide level2">
<h2></h2>
<p>What should we do?</p>
<div class="stretch">
<p><img src='http://jacksonvoelkel.com/geog575/slide_images/norm_3rd_1.png'></p>
</div>
<ul>
<li>Split into two tables:</li>
<li>Employee</li>
<li>Department</li>
</ul>
</section><section id="section-122" class="slide level2">
<h2></h2>
<div class="stretch">
<p><img src='http://jacksonvoelkel.com/geog575/slide_images/norm_3rd_2.png'></p>
</div>
</section></section>
<section><section id="boyce-codd-normal-form" class="titleslide slide level1"><h1>Boyce-Codd Normal Form</h1></section><section id="section-123" class="slide level2">
<h2></h2>
<blockquote>
A table is in Boyce–Codd normal form if every determinant could be a primary key
</blockquote>
<p>If any field is a <span style="color:orange">determinant</span>, it must be able to be the PK.</p>
<ul>
<li>Determinant = determines the value of some other field</li>
</ul>
</section><section id="section-124" class="slide level2">
<h2></h2>
<div style="text-align:left">
<p class="fragment">
[1st] A <span style="color:orange">table</span> is based on
</p>
<p class="fragment">
[2nd] the <span style="color:orange">key</span>,
</p>
<p class="fragment">
[3rd] the <span style="color:orange">whole key</span>,
</p>
<p class="fragment">
[ BC] and <span style="color:orange">nothing but the key</span> (so help me Codd)
</p>
</div>
</section></section>
<section><section id="from-first-to-third" class="titleslide slide level1"><h1>From First to Third</h1></section><section id="first" class="slide level2">
<h2>FIRST</h2>
<p>Require there be only one value per cell.</p>
<div class="stretch" style="background-color:white">
<p><img src='http://jacksonvoelkel.com/geog575/slide_images/norm2_first.png'></p>
</div>
</section><section id="section-125" class="slide level2">
<h2></h2>
<div class="stretch" style="background-color:white">
<p><img src='http://jacksonvoelkel.com/geog575/slide_images/norm2_first_2.png'></p>
</div>
</section><section id="second" class="slide level2">
<h2>SECOND</h2>
<p>Row must depend on the entire primary key.</p>
<div class="stretch" style="background-color:white">
<p><img src='http://jacksonvoelkel.com/geog575/slide_images/norm2_second_1.png'></p>
</div>
</section><section id="section-126" class="slide level2">
<h2></h2>
<div class="stretch" style="background-color:white">
<p><img src='http://jacksonvoelkel.com/geog575/slide_images/norm2_second_2.png'></p>
</div>
<ul>
<li>Room number doesn’t depend on last name or first name.</li>
<li>Moving to a new ‘Class’ class makes use lose a natural PK! We’ll need a synthetic one on ‘Students’.</li>
</ul>
</section><section id="section-127" class="slide level2">
<h2></h2>
<p><small>A student’s grade is not <i>wholly</i> dependent on a student, rather it is dependent on <i>both</i> a student and the class they are in.</small></p>
<div class="stretch" style="background-color:white">
<p><img src='http://jacksonvoelkel.com/geog575/slide_images/norm2_third_1.png'></p>
</div>
<p><small>Grades table now has a PK built from two FKs.</small></p>
</section><section id="section-128" class="slide level2">
<h2></h2>
<p>Do we stil need “status” in it’s own table?</p>
<div style="text-align:left">
<p>Is dependent on ‘Last Name’ + ’First Name? <span class="fragment" style="color:orange">Well, there <i>could</i> be more than one Bruce Wayne</span></p>
<p>What should we do? <span class="fragment" style="color:orange">I would leave it in a seperate table.</span></p>
</div>
<div class="stretch" style="background-color:white">
<p><img src='http://jacksonvoelkel.com/geog575/slide_images/norm2_third_1.png'></p>
</div>
</section></section>
<section><section id="week-3-reading-assignment" class="titleslide slide level1"><h1>Week 3 Reading Assignment</h1></section><section id="some-notes" class="slide level2">
<h2>Some Notes</h2>
<div style="text-align:left">
<ul>
<li>My aim this week was to get you some experience.</li>
<li>Hard with fake data</li>
<li>Author throws in curveballs</li>
<li>It’s still quite a good book…</li>
<li>… but we are moving on from it.</li>
<li>Want to know the answers, according to Churcher?</li>
</ul>
</div>
</section></section>
<section><section id="next-week-2" class="titleslide slide level1"><h1>Next week:</h1></section><section id="assignment-more-normalizaton" class="slide level2">
<h2>Assignment: More Normalizaton</h2>
</section><section id="lab-table-creation" class="slide level2">
<h2>Lab: Table Creation</h2>
</section><section id="a-brief-rundown-of-indexes" class="slide level2">
<h2>A Brief rundown of Indexes</h2>
<ul>
<li>Indices?</li>
<li><a href="https://www.postgresql.org/docs/9.6/static/indexes.html" target="_blank">Indexes?</a></li>
<li>Whatever.</li>
</ul>
</section><section id="midterm-prep" class="slide level2">
<h2>Midterm prep!</h2>
</section></section>
<section><section id="week-4-lab" class="titleslide slide level1"><h1>Week 4 Lab</h1></section><section id="section-129" class="slide level2">
<h2>1</h2>
<p>Write the SQL to add the following products to the product table:</p>
<table>
<thead>
<tr class="header">
<th>prod_id</th>
<th>vend_id</th>
<th>prod_name</th>
<th>prod_price</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>CO02</td>
<td>FNG01</td>
<td>Fireman Costume</td>
<td>24.99</td>
</tr>
<tr class="even">
<td>CO03</td>
<td>FNG01</td>
<td>Policeman Costume</td>
<td>24.99</td>
</tr>
<tr class="odd">
<td>MISC01</td>
<td>JTS01</td>
<td>Kiddie Grab Bag</td>
<td>4.99</td>
</tr>
</tbody>
</table>
</section><section id="section-130" class="slide level2">
<h2></h2>
<pre>INSERT INTO products (
        prod_id
        , vend_id
        , prod_name
        , prod_price)
VALUES  ('CO02','FNG01','Fireman Costume',24.99),
        ('CO03','FNG01','Policeman Costume',24.99),
        ('MISC01','JTS01','Kiddie Grab Bag',4.99);</pre>
</section><section id="section-131" class="slide level2">
<h2>2</h2>
<p>Write SQL to correct the cost of the two costumes added. The cost should be the same as the witch costume. note: you should not do this by simply looking up the cost, then updating the data, your SQL statement should include the querying of the database to get the cost of the costume. This can and should be done in a single statement.</p>
</section><section id="section-132" class="slide level2">
<h2></h2>
<pre>UPDATE products
SET prod_price = (
        SELECT prod_price FROM products
        WHERE prod_name='Witch Costume')
WHERE prod_name LIKE '%Costume%'
AND prod_price != (
        SELECT prod_price FROM products
        WHERE prod_name = 'Witch Costume');</pre>
</section><section id="section-133" class="slide level2">
<h2>3</h2>
<p>Now we have decided to cut our product line, starting with the new products. Remove the three products you just added.</p>
</section><section id="section-134" class="slide level2">
<h2></h2>
<pre>
DELETE FROM products WHERE prod_id IN (‘CO02’,‘CO03’,‘MISC01’);
<p re>
</section><section id="section-135" class="slide level2">
<h2>4</h2>
<p>Before you executed the statements to remove the products you added, what could you have done to ensure that you only delete the desired rows?</p>
<p>Consider a table created with this command:</p>
<pre>CREATE TABLE students (
  id_num varchar(9) NOT NULL,
  last_name varchar(15) NOT NULL,
  first_name varchar(15) NOT NULL,
  middle_name varchar(15) NOT NULL,
  address varchar(30) NOT NULL,
  city varchar(15) NOT NULL,
  state varchar(2) NOT NULL,
  zip varchar(5) NOT NULL,
  date_enrolled date);</pre>
</section><section id="section-136" class="slide level2">
<h2>5</h2>
<p>Write a statement that creates a primary key constraint using the id_num column.</p>
</section><section id="section-137" class="slide level2">
<h2></h2>
<pre>ALTER TABLE students
ADD PRIMARY KEY (id_num);</pre>
</section><section id="section-138" class="slide level2">
<h2>6</h2>
<p>Write a statement to allow the middle_name column to accept NULL values.</p>
</section><section id="section-139" class="slide level2">
<h2></h2>
<pre>ALTER TABLE students
ALTER COLUMN middle_name DROP NOT NULL;</pre>
</section><section id="section-140" class="slide level2">
<h2>7</h2>
<p>Write a statement that would restrict the people added into table to only reside in the state of New York (‘NY’)?</p>
</section><section id="section-141" class="slide level2">
<h2></h2>
<pre>ALTER TABLE students
ADD CONSTRAINT checkState CHECK(state = 'NY');</pre>
</section><section id="section-142" class="slide level2">
<h2>8</h2>
<p>What statement would you use to add an auto-incrementing column called student_id to the preceding table?</p>
</section><section id="section-143" class="slide level2">
<h2></h2>
<pre>ALTER TABLE students
ADD COLUMN student_id SERIAL;</pre>
</section><section id="section-144" class="slide level2">
<h2>9</h2>
<p>If you haven’t already, create the table and execute commands 5-8. Now, add yourself to the table as a student, but using the zipcode ‘01230’. What SQL did you use?</p>
</section><section id="section-145" class="slide level2">
<h2></h2>
<pre>INSERT INTO students(id_num,                                                     
 last_name,
 first_name,
 middle_name,
 address,
 city,
 state,
 zip,
 date_enrolled)
VALUES(969645908,
 'Voelkel',
 'Jackson',
 'Lee',
 '506 SW Mill St.',
 'Yonkers',
 <span style="color:orange">'NY'</span>,
 '01230',
 '2/07/2018');</pre>
</section><section id="section-146" class="slide level2">
<h2>10</h2>
<p>Now write a SQL statement that converts the zipcode column to an integer (this is tricky, but here’s a hint, you’ll need to include USING cast(zip as integer) in your statement.</p>
</section><section id="section-147" class="slide level2">
<h2></h2>
<pre>ALTER TABLE students
ALTER COLUMN zip TYPE INTEGER USING CAST(zip AS INTEGER)</pre>
<p>… or …</p>
<pre>ALTER TABLE students
ALTER COLUMN zip TYPE INTEGER USING zip::integer</pre>
</section><section id="section-148" class="slide level2">
<h2>11</h2>
<p>What does the cast function do?</p>
</section><section id="section-149" class="slide level2">
<h2>12</h2>
<p>Now read back the row you added to the table. What happened to the zipcode? Why?</p>
</section><section id="section-150" class="slide level2">
<h2>13</h2>
<p>Write and execute the SQL to create a view students_ny that shows only those students in New York state.</p>
</section><section id="section-151" class="slide level2">
<h2></h2>
<pre>CREATE VIEW students_ny AS
SELECT * from students
WHERE state = 'NY';</pre>
</section><section id="section-152" class="slide level2">
<h2>14</h2>
<p>Write a SQL statement creates a summarized view containing the average pay rate and average salary for each city in the employees table.</p>
</section><section id="section-153" class="slide level2">
<h2></h2>
<pre>CREATE VIEW avg_pay_city AS
SELECT AVG(P.pay_rate) avg_rate
    , AVG(P.salary) avg_salary
    , E.city
FROM employee_pay P, employees AS E
WHERE P.emp_id = E.emp_id
GROUP BY E.city;</pre>
</section><section id="section-154" class="slide level2">
<h2>15</h2>
<p>Make sure your view from question 13 exists. Now, write a SQL statement that drops the students table. What happens when you execute this statement? How do you make it work using a single statement?</p>
</section><section id="section-155" class="slide level2">
<h2></h2>
<pre>DROP TABLE students CASCADE;</pre>
</section></section>
<section><section id="normalization-assignment" class="titleslide slide level1"><h1>Normalization Assignment</h1></section><section id="whats-the-most-wrong" class="slide level2">
<h2>What’s (the most) wrong?</h2>
<ul>
<li>Multiple values… this isn’t really a table!</li>
</ul>
</section><section id="section-156" class="slide level2">
<h2></h2>
<table>
<thead>
<tr class="header">
<th>Park</th>
<th>Amenity</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>Baseball</td>
</tr>
<tr class="even">
<td>1</td>
<td>Soccer</td>
</tr>
<tr class="odd">
<td>1</td>
<td>Playground</td>
</tr>
<tr class="even">
<td>2</td>
<td>Soccer</td>
</tr>
<tr class="odd">
<td>3</td>
<td>Horesshoes</td>
</tr>
<tr class="even">
<td>3</td>
<td>Soccer</td>
</tr>
<tr class="odd">
<td>3</td>
<td>Baseball</td>
</tr>
<tr class="even">
<td>3</td>
<td>Basketball</td>
</tr>
<tr class="odd">
<td>…</td>
<td>…</td>
</tr>
<tr class="even">
<td>13</td>
<td>Playground</td>
</tr>
<tr class="odd">
<td>13</td>
<td>Baseball</td>
</tr>
<tr class="even">
<td>13</td>
<td>Soccer</td>
</tr>
<tr class="odd">
<td>13</td>
<td>Basketball</td>
</tr>
</tbody>
</table>
</section><section id="section-157" class="slide level2">
<h2></h2>
<table>
<thead>
<tr class="header">
<th>park_id</th>
<th>park_name</th>
<th>area</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>Arbor Lodge Park</td>
<td>8.69</td>
</tr>
<tr class="even">
<td>2</td>
<td>Gammans Park</td>
<td>1.66</td>
</tr>
<tr class="odd">
<td>3</td>
<td>Columbia Park</td>
<td>34.52</td>
</tr>
<tr class="even">
<td>4</td>
<td>McCoy Park</td>
<td>3.57</td>
</tr>
<tr class="odd">
<td>5</td>
<td>Columbia Park Pool</td>
<td>0.85</td>
</tr>
<tr class="even">
<td>6</td>
<td>University CC</td>
<td>4.46</td>
</tr>
<tr class="odd">
<td>7</td>
<td>University Park</td>
<td>7.03</td>
</tr>
<tr class="even">
<td>8</td>
<td>Portsmouth Park</td>
<td>4.03</td>
</tr>
<tr class="odd">
<td>9</td>
<td>St. Johns Community Center</td>
<td>1.34</td>
</tr>
<tr class="even">
<td>10</td>
<td>Pier Park</td>
<td>83.43</td>
</tr>
<tr class="odd">
<td>11</td>
<td>St J. Racquet C.</td>
<td>1.26</td>
</tr>
<tr class="even">
<td>12</td>
<td>St J. Park</td>
<td>4.53</td>
</tr>
<tr class="odd">
<td>13</td>
<td>McKenna Park</td>
<td>4.52</td>
</tr>
</tbody>
</table>
</section><section id="now-what" class="slide level2">
<h2>Now what?</h2>
</section><section id="section-158" class="slide level2">
<h2></h2>
<table>
<thead>
<tr class="header">
<th>nbo_id</th>
<th>nbo_name</th>
<th>assoc_chair</th>
<th>pop</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>Arbor Lodge</td>
<td>Jed Baum</td>
<td>4881</td>
</tr>
<tr class="even">
<td>2</td>
<td>Portsmouth</td>
<td>John Smith</td>
<td>10822</td>
</tr>
<tr class="odd">
<td>3</td>
<td>St. Johns</td>
<td>Peter Gabrian</td>
<td>14294</td>
</tr>
<tr class="even">
<td>4</td>
<td>University Park</td>
<td>Dr. Smarty Pants</td>
<td>5802</td>
</tr>
</tbody>
</table>
</section><section id="can-we-include-nbo_id-in-the-parks-table" class="slide level2">
<h2>Can we include nbo_id in the parks table?</h2>
<ul>
<li>Why?</li>
</ul>
</section><section id="what-else-is-wrong" class="slide level2">
<h2>What else is wrong?</h2>
<ul>
<li>Portsmouth Park</li>
<li>University Park</li>
<li>… Columbia Park</li>
</ul>
</section><section id="what-do-we-need-to-add" class="slide level2">
<h2>What do we need to add?</h2>
</section><section id="intermediary-table" class="slide level2">
<h2>Intermediary Table</h2>
<table>
<thead>
<tr class="header">
<th>park_id</th>
<th>nbo_id</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>1</td>
</tr>
<tr class="even">
<td>2</td>
<td>1</td>
</tr>
<tr class="odd">
<td>3</td>
<td>2</td>
</tr>
<tr class="even">
<td>3</td>
<td>4</td>
</tr>
<tr class="odd">
<td>4</td>
<td>2</td>
</tr>
<tr class="even">
<td>5</td>
<td>2</td>
</tr>
<tr class="odd">
<td>6</td>
<td>2</td>
</tr>
<tr class="even">
<td>7</td>
<td>2</td>
</tr>
<tr class="odd">
<td>8</td>
<td>4</td>
</tr>
<tr class="even">
<td>9</td>
<td>3</td>
</tr>
<tr class="odd">
<td>10</td>
<td>3</td>
</tr>
<tr class="even">
<td>11</td>
<td>3</td>
</tr>
<tr class="odd">
<td>12</td>
<td>3</td>
</tr>
<tr class="even">
<td>13</td>
<td>4</td>
</tr>
</tbody>
</table>
</section></section>
<section><section id="midterm" class="titleslide slide level1"><h1>Midterm</h1></section><section id="what-are-we-looking-at" class="slide level2">
<h2>What are we looking at?</h2>
<p><a href="https://www.youtube.com/watch?v=13liVWaR5yo" target="_blank">Assateague Wild Horses</a></p>
</section><section id="project-overview" class="slide level2">
<h2>Project Overview</h2>
<div style="text-align:left">
<p class="fragment">
Two new tables: allpony and banddata
</p>
<p class="fragment">
Create a fully normalized data model
</p>
<p class="fragment">
No ‘manual’ manipulation (e.g. Excel)
</p>
</div>
</section><section id="deliverables" class="slide level2">
<h2>Deliverables</h2>
<div style="text-align:left">
<p class="fragment">
A brief report (~500 words); ER diagram (with cardinality, PK/FK)
</p>
<p class="fragment">
SQL code; this <i>must</i> run!
</p>
</div>
</section><section id="advice" class="slide level2">
<h2>Advice</h2>
<div style="text-align:left">
<p class="fragment">
Do not create data that isn’t there (not including synthetic PKs)
</p>
<p class="fragment">
Do no worry about future data needs - model the data you have <b>only</b>
</p>
<p class="fragment">
Use the comma_split() function
</p>
<pre class="fragment">SELECT 'apple,orange,kiwi,grapefruit', 'a,b,c,d'</pre>
<pre class="fragment">SELECT
  comma_split('apple,orange,kiwi,grapefruit')
  , comma_split('a,b,c,d');</pre>
<p class="fragment">
Print out the heads of the tables
</p>
<p class="fragment">
Draw, draw, draw - ER diagrams can help
</p>
<p class="fragment">
Get your hands dirty - experiment with the data
</p>
</div>
</section><section id="other-info" class="slide level2">
<h2>Other info</h2>
I will be out of town and busy from Thursday until Sunday morning, but you <em>might</em> get a response from me on slack <span class="fragment">… and you can always contact other classmates!
</p>
</section></section>
<section><section id="next-week-3" class="titleslide slide level1"><h1>Next week</h1></section><section id="midterm-1" class="slide level2">
<h2>Midterm</h2>
<ul>
<li>anger</li>
<li>frustration</li>
<li>lessons learned</li>
</ul>
</section><section id="indexes" class="slide level2">
<h2>Indexes</h2>
<ul>
<li>What are they doing?</li>
<li>Why are they important?</li>
</ul>
</section><section id="and" class="slide level2">
<h2>and …</h2>
</section><section id="section-159" class="slide level2">
<h2></h2>
<div class="stretch fragment">
<p><img src='http://jacksonvoelkel.com/geog575/slide_images/spatial_data.gif'> <img src='http://jacksonvoelkel.com/geog575/slide_images/scream.gif'></p>
</div>
</section></section>
<section><section id="congrats-you-finished-the-midterm" class="titleslide slide level1"><h1>Congrats, you finished the midterm!</h1></section></section>
<section><section id="midterm-2" class="titleslide slide level1"><h1>Midterm #2</h1></section><section id="section-160" class="slide level2">
<h2></h2>
<p>(Just kidding)</p>
</section></section>
<section><section id="midterm-recap" class="titleslide slide level1"><h1>Midterm recap</h1></section><section id="what-is-wrong" class="slide level2">
<h2>What is wrong?</h2>
</section><section id="how-do-we-fix-it" class="slide level2">
<h2>How do we fix it?</h2>
<p><span class="fragment">First, let’s make a <code>horses</code> table!</span></p>
</section><section id="creating-horses-table" class="slide level2">
<h2>Creating horses table</h2>
<pre>CREATE TABLE horses (
    horse_id <span style="color:orange">CHAR(10) NOT NULL PRIMARY KEY</span>
    , birth_date  <span style="color:orange">date NULL</span>
    , status  <span style="color:orange">CHAR(15)</span>
    , sex  <span style="color:orange">CHAR(1)</span>
    , color  <span style="color:orange">CHAR(20)</span>
    , "name"  <span style="color:orange">CHAR(40)</span>
    , howmarked  <span style="color:orange">CHAR(70)</span>
    , date_terminate  <span style="color:orange">DATE</span>
    , notes  <span style="color:orange">TEXT</span>
    , sire_genetic  <span style="color:orange">CHAR(10)</span>
);</pre>
</section><section id="inserting-data-into-horses" class="slide level2">
<h2>Inserting data into horses</h2>
<pre>INSERT INTO horses (
    horse_id
    , birth_date
    , status
    , sex
    , color
    , "name"
    , howmarked
    , date_terminate
    , notes
    , sire_genetic)</pre>
<p>…</p>
</section><section id="section-161" class="slide level2">
<h2></h2>
<pre>SELECT DISTINCT 
    horse_id
    , birth_date
    , status
    , sex
    , color
    , "name"
    , howmarked
    , date_terminate
    , notes
    , sire_genetic
FROM allpony
-- Adding a similar table from banddata
--  onto the above selection:
UNION</pre>
<p>…</p>
</section><section id="section-162" class="slide level2">
<h2></h2>
<pre>SELECT DISTINCT 
    id
    , CAST(NULL AS DATE) AS birth_date
    , NULL AS status
    , sex
    , color
    , "name"
    , NULL as howmarked
    , CAST(NULL AS DATE) AS date_terminate
    , NULL AS notes
    , NULL AS sire_genetic
FROM banddata
--Using a subquery to find all horses that were
--  not accounted for in allpony.
WHERE id in (
    SELECT DISTINCT id FROM banddata
    EXCEPT
    SELECT DISTINCT horse_id from allpony);
SELECT * FROM horses;</pre>
</section><section id="cont.-dates" class="slide level2">
<h2>Cont. dates</h2>
<p>Now, let’s make a <code>cont_dates</code> table!</p>
</section><section id="create-the-table" class="slide level2">
<h2>Create the table</h2>
<pre>DROP TABLE IF EXISTS cont_dates;
CREATE TABLE cont_dates (
    horse_id <span style="color:orange">CHAR(10) REFERENCES horses(horse_id)</span>
    , cont_date <span style="color:orange">CHAR(7)</span>
    -- Adding a primary key as the combination of both fields:
    , PRIMARY KEY(horse_id,cont_date)
);</pre>
</section><section id="inserting-data" class="slide level2">
<h2>Inserting data</h2>
<pre>INSERT INTO cont_dates
--Using the comma_split function to fix multi-value issue:
SELECT DISTINCT horse_id, comma_split(conthow) AS cont_date
FROM allpony;
SELECT * FROM cont_dates;</pre>
</section><section id="births" class="slide level2">
<h2>Births</h2>
<p>We need a table to record foal <code>births</code>!</p>
</section><section id="births-creation" class="slide level2">
<h2>‘births’ creation</h2>
<pre>DROP TABLE IF EXISTS births;
CREATE TABLE births (
    horse_id <span style="color:orange">CHAR(10) REFERENCES horses(horse_id)</span>
    , foal_yr <span style="color:orange">CHAR(4)</span>
    -- Adding a primary key as the combination of both fields:
    , PRIMARY KEY(horse_id,foal_yr)
);</pre>
</section><section id="inserting-data-to-births" class="slide level2">
<h2>Inserting data to ‘births’</h2>
<pre>INSERT INTO births
SELECT horse_id, <span style="color:green">comma_split</span>(foals_produced) AS foal_yr
FROM allpony;
SELECT * FROM births;</pre>
</section><section id="observations" class="slide level2">
<h2>Observations</h2>
<p>We can de-clutter the banddata table even further by selecting out some distinct band <code>observations</code></p>
</section><section id="section-163" class="slide level2">
<h2></h2>
<pre>DROP TABLE IF EXISTS band_obs CASCADE;
-- Creating a new table from all fields that revolve 
-- around band information/observations.
CREATE TABLE band_obs AS
SELECT DISTINCT "date"
    , band
    , bandsize
    , "zone"
    , <span style="color:orange">UPPER("location")</span> as "location"
    , <span style="color:orange">UPPER(habitat)</span> as "habitat"
    , utm_east
    , utm_north
FROM banddata;

ALTER TABLE band_obs
ADD COLUMN obs_id SERIAL PRIMARY KEY;
SELECT * FROM band_obs;</pre>
<p>What’s the deal with <span style="color:orange">UPPER()</span>?</p>
</section><section id="intermediary-table-1" class="slide level2">
<h2>Intermediary Table</h2>
<p>Finally, we need a table to join Horses to Observations!</p>
</section><section id="creating-the-table" class="slide level2">
<h2>Creating the table</h2>
<pre>CREATE TABLE horse_obsID AS
SELECT id, obs_id FROM band_obs AS j left JOIN banddata AS b
    ON <span style="color:green">concat</span>(j.band
      , j.date
      , j.zone
      , UPPER(j.location)
      , UPPER(j.habitat)
      , j.bandsize) = 
    <span style="color:green">concat</span>(b.band
      , b.date
      , b.zone
      , UPPER(b.location)
      , UPPER(b.habitat)
      , b.bandsize);</pre>
</section><section id="adding-constraints" class="slide level2">
<h2>Adding constraints</h2>
<pre>ALTER TABLE horse_obsID
ADD CONSTRAINT horse_fk FOREIGN KEY (id) REFERENCES horses(horse_id);
ALTER TABLE horse_obsID
ADD CONSTRAINT obs_fk FOREIGN KEY (obs_id) REFERENCES band_obs(obs_id);
ALTER TABLE horse_obsID
ADD CONSTRAINT horse_obsID_pk PRIMARY KEY(id,obs_id);

SELECT * FROM horse_obsID
order by obs_id DESC;</pre>
</section><section id="does-it-work" class="slide level2">
<h2>Does it work?</h2>
<pre>SELECT *
FROM band_obs, horses, horse_obsID
WHERE horse_obsID.obs_id = band_obs.obs_id
    AND horses.horse_id = horse_obsID.id
    AND horses.horse_id = 'M2M'
ORDER BY band_obs.date;</pre>
</section><section id="entity-relation-diagram" class="slide level2">
<h2>Entity-Relation Diagram</h2>
<p>Where do we start?</p>
<p>Any volunteers?</p>
</section><section id="section-164" class="slide level2">
<h2></h2>
<div class="stretch">
<p><img src='http://jacksonvoelkel.com/geog575/slide_images/midterm_er.jpg'></p>
</div>
</section><section id="time-spent" class="slide level2">
<h2>Time spent?</h2>
</section><section id="why-did-we-do-this" class="slide level2">
<h2>Why did we do this?</h2>
<ul>
<li>Why would anyone do this?</li>
<li>Drive home clean data</li>
<li>SQL practice</li>
</ul>
</section><section id="is-this-forever" class="slide level2">
<h2>Is this forever?</h2>
<p>No!</p>
<ul>
<li>Start clean!</li>
</ul>
</section></section>
<section><section id="indexes-1" class="titleslide slide level1"><h1>Indexes</h1></section><section id="finding-information" class="slide level2">
<h2>Finding Information</h2>
<div class="stretch">
<p><img src='http://jacksonvoelkel.com/geog575/slide_images/Index_1.jpg'></p>
</div>
</section><section id="section-165" class="slide level2">
<h2></h2>
<div class="stretch">
<p><img src='http://jacksonvoelkel.com/geog575/slide_images/Index_2.jpg'></p>
</div>
</section><section id="section-166" class="slide level2">
<h2></h2>
<div class="stretch">
<p><img src='http://jacksonvoelkel.com/geog575/slide_images/Index_3.jpg'></p>
</div>
</section><section id="section-167" class="slide level2">
<h2></h2>
<div class="stretch">
<p><img src='http://jacksonvoelkel.com/geog575/slide_images/Index_4.jpg'></p>
</div>
</section></section>
<section><section id="spatial-data" class="titleslide slide level1"><h1>Spatial Data</h1></section><section id="section-168" class="slide level2">
<h2></h2>
<p>Spatial isn’t special <span class="fragment">… at least to a RDMS!</span></p>
<pre class="fragment">select * from schools;</pre>
</section><section id="storing-geometry" class="slide level2">
<h2>Storing Geometry</h2>
<p>Why did that look so weird?</p>
<pre class="fragment">select  school_id 
        ,name 
        ,address 
        ,city   
        ,level 
        ,district 
        ,type  
        , ST_ASTEXT(ST_Transform(geom,4326)) geom
from schools;</pre>
</section><section id="projections" class="slide level2">
<h2>Projections</h2>
<pre>SELECT  school_id 
        ,name 
        ,address 
        ,city   
        ,level 
        ,district 
        ,type  
        , ST_AsEWKT(geom)
FROM schools
LIMIT 10;</pre>
<p><a href="http://spatialreference.org/ref/epsg/2913/" target="_blank">What is this ‘2913’?</a></p>
</section><section id="supported-geometries" class="slide level2">
<h2>Supported Geometries</h2>
<div class="stretch">
<p><img height="580px" src='http://jacksonvoelkel.com/geog575/slide_images/OGC_geometries.png'></p>
</div>
</section><section id="section-169" class="slide level2">
<h2></h2>
<pre>select * from blockgrp2010
limit 100;</pre>
<pre class="fragment">SELECT  fips
        , pop10
        , du10
        , ST_AsTEXT(ST_Transform(geom, 4326))
FROM blockgrp2010
LIMIT 100;</pre>
</section><section id="section-170" class="slide level2">
<h2></h2>
<p>Easy to convert to GeoJSON (web GIS!)</p>
<pre>SELECT  fips
        , ST_AsGeoJSON(ST_Transform(geom, 4326))
FROM blockgrp2010
LIMIT 100;</pre>
</section><section id="section-171" class="slide level2">
<h2></h2>
<p>… and that’s it for today!</p>
</section><section id="next-week-4" class="slide level2">
<h2>Next Week</h2>
<ul>
<li>Longer lab, start early. But it is fun!</li>
<li>Ignore the reading.</li>
</ul>
<script>
  $("p").has("img").each(function(){$(this).replaceWith($('<div class="stretch">' + this.innerHTML + '</div>'));});
  $("p").has("iframe").each(function(){$(this).replaceWith($(this.innerHTML));});
  $("img").each(function(){$(this).replaceWith($('<img src=' + this.src + '>' + this.innerHTML + '</img>'));});
  $("li").addClass("fragment");
</script>
</section></section>
    </div>
  </div>

  <script src="index_files/reveal.js-3.3.0.1/lib/js/head.min.js"></script>
  <script src="index_files/reveal.js-3.3.0.1/js/reveal.js"></script>

  <script>

      // Full list of configuration options available at:
      // https://github.com/hakimel/reveal.js#configuration
      Reveal.initialize({
        // Push each slide change to the browser history
        history: true,
        // Vertical centering of slides
        center: false,
        // Transition style
        transition: 'slide', // none/fade/slide/convex/concave/zoom
        // Transition style for full page slide backgrounds
        backgroundTransition: 'default', // none/fade/slide/convex/concave/zoom



        // Optional reveal.js plugins
        dependencies: [
          { src: 'index_files/reveal.js-3.3.0.1/plugin/zoom-js/zoom.js', async: true },
        ]
      });
    </script>
  <!-- dynamically load mathjax for compatibility with self-contained -->
  <script>
    (function () {
      var script = document.createElement("script");
      script.type = "text/javascript";
      script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
      document.getElementsByTagName("head")[0].appendChild(script);
    })();
  </script>

<script>
  (function() {
    if (window.jQuery) {
      Reveal.addEventListener( 'slidechanged', function(event) {  
        window.jQuery(event.previousSlide).trigger('hidden');
        window.jQuery(event.currentSlide).trigger('shown');
      });
    }
  })();
</script>


  </body>
</html>
